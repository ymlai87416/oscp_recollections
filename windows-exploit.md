# Windows exploit

## useful tools

* fgdump.exe
    * call without any parameters create 3 files, only file with .pwdump has the hash
    * Sample: Administrateur:500:B0347EB22B87E3F1AAD3B435B51404EE:711EFD7CDC285C11DDFAE2B3D9861DB1:::

* windows-priv-check2.exe

    * https://github.com/pentestmonkey/windows-privesc-check
    * good tools for enumeration, report in html format

* nc.exe

    * reverse in plain text
    * nc -nvlp 4444 for listening

* plink.exe

    * console application with putty

* accesschk.exe/ icalcs.exe

    * accesschk is from sysinternal
    * icalcs is win7 command
    * simple explanation: https://ephrain.net/windows-使用-icacls-指令-與-accesschk-工具檢查設定檔案存取權限/

* wce.exe

    * https://www.ampliasecurity.com/research/windows-credentials-editor/
    * seems have more advance feature, learn to use it.

## important directory

C:\

## useful command

* Create a user to login to remote desktop
    net user oscp oscp /add
    net localgroup oscp administrators /add

* Check file permission (XP: cacls, Win7: icacls)

```
C:\Users\ymlai>icacls b.txt
b.txt NT AUTHORITY\SYSTEM:(F)
      BUILTIN\Administrators:(F)
      machine\user:(F)

Successfully processed 1 files; Failed processing 0 files
```

### registry

* Check for saved password in registry
```
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon" 2>nul | findstr "DefaultUserName DefaultDomainName DefaultPassword"
```

### XMAPP

    apache => 
    log => 

### IIS

    wwwroot => C:\wwwroot

### VNC

* https://www.raymond.cc/blog/crack-or-decrypt-vnc-server-encrypted-password/
* https://github.com/jeroennijhof/vncpwd


## Privilege escalation

* Add administrative user 
    * net user hacker hacker /add
    * net localgroup administrators hacker /add

* MS11-080 - only work on my windows machine

## Transfer file

Use powershell (shorter) vbs (longer) to do it..
once you have nc, it can be done in Linux way.

https://sushant747.gitbooks.io/total-oscp-guide/transfering_files_to_windows.html 

## Smb pass the hash


## Privilege escalation

http://www.fuzzysecurity.com/tutorials/16.html

## Exploit

| Exploit  | Type  | Target  | Effect  |   |
|---|---|---|---|---|
| MS06-087  |   | SMB  | administrator  |   |
|   |   |   |   |   |
|   |   |   |   |   |

## Useful file

* nc.exe